@{
    ViewBag.Title = "list";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@Html.Action("GetTitleStyle", "DisplayLayout", new
{
    name = "长江科学院-EnglisNews"
})

@model List<crsri.cn.Model.t_web_article_model>
<script type="text/javascript">
    function goPage() {

        var inputDigit = $(".fanye").find(":input").val();
        let reg = /^\d/;
        if (reg.test(inputDigit)) {

            var url = window.location.href;
            var lastnum = url.substring(url.lastIndexOf("/") + 1);
            var goUrl = lastnum.length == 6 ? url + "/1" : url.substring(0, url.lastIndexOf("/")) + "/" + inputDigit;
            console.log(goUrl);
            window.location.href = goUrl;
        }
    }
</script>
<link href="/Content/themes/crsri/css/enStyle.css" rel="stylesheet">
<style type="text/css">
    .zy_cur a {
        color: #fff;
    }

    .zy_cur span {
        color: #fff;
    }
</style>
<div class="mainContent" style="margin-bottom:20px;">
    <div class="enNewsHead backshadow">
        <div class="enNewHead_icon"></div>
    </div>
    <div class="enNav_box">
        <div class="enNav">
            <div class="siteNav fix" style="margin-top:0px;">
                <div class=" l fix zy_cur">
                    <span class="l w_circle"></span>
                    <p class="l">
                        <a href="/Home/">Home</a><a href="/EnNews/list/018003" id="curSubjectItem">
                            English News
                        </a>
                    </p>
                </div>

            </div>
        </div>
    </div>
    <!-- 内容展示块-->
    <div class="enContent backshadow">
        <div class="english_list">
            <ul>
                @{
                    foreach (crsri.cn.Model.t_web_article_model m in Model)
                    {
                        <li><b>·</b><a href="/EnNews/index/@inside.crsri.Utility.helper.UrlEncry(@m.articleID)" target="_blank">@System.Web.HttpUtility.HtmlDecode(@m.title)</a><span>[@Convert.ToDateTime(@m.releaseTime).ToString("yyyy-MM-dd").Substring(5)]</span></li>
                    }
                }
            </ul>

            <div class="fanye" style="text-align: left;margin-left:10px;padding-bottom:20px;">
                @{
                    int pageSize = 15;
                    int totalCount = Convert.ToInt32(ViewBag.totalCount);
                    int maxPage = totalCount % pageSize == 0 ? totalCount / pageSize : totalCount / pageSize + 1;

                    if (maxPage > 1)
                    {
                        int curPage = Convert.ToInt32(ViewBag.currentPage);
                        int showPage = maxPage < 3 ? maxPage : 3;
                        List<int> txtPageNum = new List<int>();
                        if (maxPage <= showPage)
                        {
                            for (int i = 1; i <= maxPage; i++)
                            {
                                txtPageNum.Add(i);
                            }
                        }
                        else
                        {
                            int startNum = curPage > 2 ? curPage - 2 : 1;

                            for (int i = startNum; i <= startNum + 2; i++)
                            {
                                txtPageNum.Add(i);
                            }


                        }

                        int prePage = curPage - 1;
                        int nextPage = curPage + 1;
                        int hidePage = txtPageNum.Last() + 1;

                        string htmlPre = string.Format("<a href='/EnNews/list/{0}/{1}'>Pre</a>", Model.First().subjectID, prePage == 0 ? 1 : prePage);
                        string htmlNext = string.Format("<a href='/EnNews/List/{0}/{1}'>Next</a>", Model.First().subjectID, nextPage > maxPage ? maxPage : nextPage);
                        string htmlInfo = string.Format("<span> Total: {0} </span>", maxPage);
                        string htmlGo = string.Format("<span>Trun<input type='text'>page</span><a href='javascript:goPage();' class='ok'>OK</a></div>");

                        @Html.Raw(htmlPre);
                    <div id="pages">
                        @foreach (int num in txtPageNum)
                        {
                            if (num == curPage)
                            {
                                @Html.Raw(string.Format("<a href='/EnNews/list/{0}/{1}' class='current'>{1}</a>", Model.First().subjectID, num));
                            }
                            else
                            {
                                @Html.Raw(string.Format("<a href='/EnNews/list/{0}/{1}'>{1}</a>", Model.First().subjectID, num));
                            }
                        }
                        @if (maxPage > 3)
                        {
                            <a href="/EnNews/List/@Model.First().subjectID/@hidePage">...</a>
                            <a href="/EnNews/List/@Model.First().subjectID/@maxPage">@maxPage</a>
                        }

                    </div>
                    @Html.Raw(htmlNext);
                    @Html.Raw(htmlInfo)
                    <p>
                        @Html.Raw(htmlGo)
                    </p>

                    }

                }

            </div>
        </div>
    </div>
</div>