@{
    Layout = null;
}
@model List<crsri.cn.Model.t_web_article_model>
<script type="text/javascript" src="/Scripts/jquery-1.11.0.min.js"></script>

<script type="text/javascript">
    function goPage() {

        var inputDigit = $(".fanye").find(":input").val();
        let reg = /^\d/;
        if (reg.test(inputDigit)) {

            var url = window.location.href;
            var lastnum = url.substring(url.lastIndexOf("/") + 1);
            var goUrl = lastnum.length == 6 ? url + "/1" : url.substring(0, url.lastIndexOf("/")) + "/" + inputDigit;
            console.log(goUrl);
            window.location.href = goUrl;
        }
    }
</script>
<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>长科院财政资金支付进度情况通报</title>
    <link rel="stylesheet" href="/Content/themes/crsri/css/children.css" />
    <link rel="stylesheet" href="/Content/themes/crsri/css/page.css" />
    <style type="text/css">
        .fanye div .current {
            color: #fff;
            background-color: #ddd;
            border: #ccc solid 1px;
        }
    </style>
</head>
<body>
    <div class="budgetpay_head"></div>
    <div class="erx-main">
        <div class="inner clearfix">
            <div class="erx-content">
                <dl class="erx-list">
                    @foreach (crsri.cn.Model.t_web_article_model m in Model)
                    {
                        <dd>
                            <div class="d">
                                <em>@Convert.ToDateTime(@m.releaseTime).ToString("yyyy-MM-dd").Substring(5)</em>
                                <i>@Convert.ToDateTime(@m.releaseTime).Year</i>
                            </div>
                            <div class="t">
                                <a href="/BudgetPay/show/@inside.crsri.Utility.helper.UrlEncry(@m.articleID)" class="m">@m.title</a>
                                <div class="i">
                                    作者:<a>@m.author</a>
                                    <i>|</i>浏览:@m.hits   <a href="/BudgetPay/show/@inside.crsri.Utility.helper.UrlEncry(@m.articleID)" class="rm" title="阅读全文"></a>
                                </div>
                            </div>
                        </dd>
                    }
                </dl>
            </div>
            <div class="fanye" style="text-align: left;border-top:none;padding-top:0px;margin-top:0px;">
                @{
                    int pageSize = 15;
                    int totalCount = Convert.ToInt32(ViewBag.totalCount);
                    int maxPage = totalCount % pageSize == 0 ? totalCount / pageSize : totalCount / pageSize + 1;

                    if (maxPage > 1)
                    {
                        int curPage = Convert.ToInt32(ViewBag.currentPage);
                        int showPage = maxPage < 3 ? maxPage : 3;
                        List<int> txtPageNum = new List<int>();
                        if (maxPage <= showPage)
                        {
                            for (int i = 1; i <= maxPage; i++)
                            {
                                txtPageNum.Add(i);
                            }
                        }
                        else
                        {
                            int startNum = curPage > 2 ? curPage - 2 : 1;

                            for (int i = startNum; i <= startNum + 2; i++)
                            {
                                txtPageNum.Add(i);
                            }


                        }

                        int prePage = curPage - 1;
                        int nextPage = curPage + 1;
                        int hidePage = txtPageNum.Last() + 1;

                        string htmlPre = string.Format("<a href='/BudgetPay/index/{0}'>上一页</a>", prePage == 0 ? 1 : prePage);
                        string htmlNext = string.Format("<a href='/BudgetPay/index/{0}'>下一页</a>", nextPage > maxPage ? maxPage : nextPage);
                        string htmlInfo = string.Format("<span>共{0}页</span>", maxPage);
                        string htmlGo = string.Format("<span>转到第<input type='text'>页</span><a href='javascript:goPage();' class='ok'>确定</a></div>");

                        @Html.Raw(htmlPre);
                    <div id="pages">
                        @foreach (int num in txtPageNum)
                        {
                            if (num == curPage)
                            {
                                @Html.Raw(string.Format("<a href='/BudgetPay/index/{0}' class='current'>{0}</a>", num));
                            }
                            else
                            {
                                @Html.Raw(string.Format("<a href='/BudgetPay/index/{0}'>{0}</a>", num));
                            }
                        }
                        <a href="/BudgetPay/index/@hidePage">...</a>
                        <a href="/BudgetPay/index/@maxPage">@maxPage</a>
                    </div>
                    @Html.Raw(htmlNext)
                    <p>
                        @Html.Raw(htmlGo)
                    </p>
                    }
                }

            </div>
        </div>

    </div>

</body>
</html>
